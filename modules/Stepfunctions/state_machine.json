{
  "Comment": "Video â†’ frames pipeline: Step Function triggers Lambda to split and dump, then Rekognition",
  "Version": "1.0",
  "StartAt": "ProcessVideo",
  "States": {
    "ProcessVideo": {
      "Type": "Task",
      "Resource": "arn:aws:states:::lambda:invoke",
      "Parameters": {
        "FunctionName": "arn:aws:lambda:${Region}:${AccountId}:function:CarCrashApp",
        "Payload": {
          "Records": [
            {
              "s3": {
                "bucket": {
                  "name.$": "$.bucket"
                },
                "object": {
                  "key.$": "$.key"
                }
              }
            }
          ]
        }
      },
      "OutputPath": "$.Payload",
      "Next": "DetectCrash"
    },
    "DetectCrash": {
      "Type": "Task",
      "Resource": "arn:aws:states:::lambda:invoke",
      "Parameters": {
        "FunctionName": "arn:aws:lambda:${Region}:${AccountId}:function:DetectCrashLambda",
        "Payload.$": "$"
      },
      "OutputPath": "$.Payload",
      "End": true
    }
  }
}